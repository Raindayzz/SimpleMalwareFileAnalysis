#!/bin/bash
#January 15th - Bryce H
##If there is any added scripts/path issues, add the scirpt with the full path to avoid
##Step 1 - find the file on the system `find / -name "<name>*" 2>/dev/null` 
##Step 2 - that should return the full that, paste that and arguments in its proper place

if [ "$#" -ne 2 ];then
	echo "Usage: ./MA.sh <FileToBeExamined> <FileExtension>"
	echo "1 - pdf"
	echo "2 - image/GIF"
	echo "3 - OLE"
	echo "4 - OOXML"
	echo "0 - testing"
	exit 1	
fi

##Set output, this could get janky if there are special char/extra "." in the string of the file
NameofFile=`echo $1 | cut -d"." -f1`
Ending=".output"
SaveFile="$NameofFile$Ending"
echo "All output will also be saved into $SaveFile";echo

case "$2" in
1)	#1 for pdf
	file $1 | tee $SaveFile
	echo "----------------------------------------------";echo | tee -a $SaveFile
	echo "PDFTK:" | tee -a $SaveFile 
	/usr/bin/pdftk $1 cat output out.pdf uncompress; strings out.pdf | grep -i http | tee -a $SaveFile
	rm -rf out.pdf	
	echo "----------------------------------------------";echo | tee -a $SaveFile
	echo "Analyze PDF:" | tee -a $SaveFile
	/opt/remnux-scripts/AnalyzePDF.py $1 | tee -a $SaveFile
	echo "----------------------------------------------";echo | tee -a $SaveFile
	echo "PDFID:" | tee -a $SaveFile
	/opt/remnux-didier/pdfid.py $1 | tee -a $SaveFile 		#Had to use full path
	echo "----------------------------------------------";echo | tee -a $SaveFile
	echo "PDF-PARSER (ALL OPTIONS)" | tee -a $SaveFile
	/opt/remnux-didier/pdf-parser.py -s js $1 | tee -a $SaveFile	#Had to use full path
;;

2)
	file $1 | tee $SaveFile
	echo "----------------------------------------------";echo | tee -a $SaveFile
	echo "Exiftool" | tee -a $SaveFile
	exiftool $1 | tee -a $SaveFile
;;

3) 
	file $1 | tee $SaveFile
	echo "----------------------------------------------";echo | tee -a $SaveFile
	/usr/bin/hachoir-subfile $1 | tee $SaveFile	
;;

4)
	file $1 | tee $SaveFile
	echo "----------------------------------------------";echo | tee -a $SaveFile
	/opt/remnux-scripts/officeparser.py $1 | tee $SaveFile
	;;
0) 
esac







